(function(){const x=document.createElement("link").relList;if(x&&x.supports&&x.supports("modulepreload"))return;for(const E of document.querySelectorAll('link[rel="modulepreload"]'))L(E);new MutationObserver(E=>{for(const O of E)if(O.type==="childList")for(const Z of O.addedNodes)Z.tagName==="LINK"&&Z.rel==="modulepreload"&&L(Z)}).observe(document,{childList:!0,subtree:!0});function U(E){const O={};return E.integrity&&(O.integrity=E.integrity),E.referrerPolicy&&(O.referrerPolicy=E.referrerPolicy),E.crossOrigin==="use-credentials"?O.credentials="include":E.crossOrigin==="anonymous"?O.credentials="omit":O.credentials="same-origin",O}function L(E){if(E.ep)return;E.ep=!0;const O=U(E);fetch(E.href,O)}})();class $t{start(){}update(){}render(){}constructor(){this.start(),tn.gameObjects.push(this)}}class An{gameObjects=[];updateStep(){for(let x=0;x<this.gameObjects.length;x++)this.gameObjects[x].update()}renderStep(){for(let x=0;x<this.gameObjects.length;x++)this.gameObjects[x].render()}}const tn=new An;function vn(w,x){return class extends w{constructor(...U){super(...U),x(this)}}}const Tn=vn(Array,w=>w.fill(0));let F=1e-6;function qn(w){function x(d=0,p=0){const M=new w(2);return d!==void 0&&(M[0]=d,p!==void 0&&(M[1]=p)),M}const U=x;function L(d,p,M){const t=M??new w(2);return t[0]=d,t[1]=p,t}function E(d,p){const M=p??new w(2);return M[0]=Math.ceil(d[0]),M[1]=Math.ceil(d[1]),M}function O(d,p){const M=p??new w(2);return M[0]=Math.floor(d[0]),M[1]=Math.floor(d[1]),M}function Z(d,p){const M=p??new w(2);return M[0]=Math.round(d[0]),M[1]=Math.round(d[1]),M}function J(d,p=0,M=1,t){const u=t??new w(2);return u[0]=Math.min(M,Math.max(p,d[0])),u[1]=Math.min(M,Math.max(p,d[1])),u}function $(d,p,M){const t=M??new w(2);return t[0]=d[0]+p[0],t[1]=d[1]+p[1],t}function at(d,p,M,t){const u=t??new w(2);return u[0]=d[0]+p[0]*M,u[1]=d[1]+p[1]*M,u}function N(d,p){const M=d[0],t=d[1],u=p[0],s=p[1],c=Math.sqrt(M*M+t*t),e=Math.sqrt(u*u+s*s),r=c*e,h=r&&At(d,p)/r;return Math.acos(h)}function m(d,p,M){const t=M??new w(2);return t[0]=d[0]-p[0],t[1]=d[1]-p[1],t}const b=m;function Mt(d,p){return Math.abs(d[0]-p[0])<F&&Math.abs(d[1]-p[1])<F}function St(d,p){return d[0]===p[0]&&d[1]===p[1]}function xt(d,p,M,t){const u=t??new w(2);return u[0]=d[0]+M*(p[0]-d[0]),u[1]=d[1]+M*(p[1]-d[1]),u}function Et(d,p,M,t){const u=t??new w(2);return u[0]=d[0]+M[0]*(p[0]-d[0]),u[1]=d[1]+M[1]*(p[1]-d[1]),u}function Gt(d,p,M){const t=M??new w(2);return t[0]=Math.max(d[0],p[0]),t[1]=Math.max(d[1],p[1]),t}function Dt(d,p,M){const t=M??new w(2);return t[0]=Math.min(d[0],p[0]),t[1]=Math.min(d[1],p[1]),t}function nt(d,p,M){const t=M??new w(2);return t[0]=d[0]*p,t[1]=d[1]*p,t}const Ut=nt;function Pt(d,p,M){const t=M??new w(2);return t[0]=d[0]/p,t[1]=d[1]/p,t}function Bt(d,p){const M=p??new w(2);return M[0]=1/d[0],M[1]=1/d[1],M}const _t=Bt;function zt(d,p,M){const t=M??new w(3),u=d[0]*p[1]-d[1]*p[0];return t[0]=0,t[1]=0,t[2]=u,t}function At(d,p){return d[0]*p[0]+d[1]*p[1]}function C(d){const p=d[0],M=d[1];return Math.sqrt(p*p+M*M)}const Lt=C;function ft(d){const p=d[0],M=d[1];return p*p+M*M}const Ot=ft;function et(d,p){const M=d[0]-p[0],t=d[1]-p[1];return Math.sqrt(M*M+t*t)}const R=et;function k(d,p){const M=d[0]-p[0],t=d[1]-p[1];return M*M+t*t}const I=k;function lt(d,p){const M=p??new w(2),t=d[0],u=d[1],s=Math.sqrt(t*t+u*u);return s>1e-5?(M[0]=t/s,M[1]=u/s):(M[0]=0,M[1]=0),M}function It(d,p){const M=p??new w(2);return M[0]=-d[0],M[1]=-d[1],M}function j(d,p){const M=p??new w(2);return M[0]=d[0],M[1]=d[1],M}const Rt=j;function yt(d,p,M){const t=M??new w(2);return t[0]=d[0]*p[0],t[1]=d[1]*p[1],t}const kt=yt;function gt(d,p,M){const t=M??new w(2);return t[0]=d[0]/p[0],t[1]=d[1]/p[1],t}const Ft=gt;function Vt(d=1,p){const M=p??new w(2),t=Math.random()*2*Math.PI;return M[0]=Math.cos(t)*d,M[1]=Math.sin(t)*d,M}function D(d){const p=d??new w(2);return p[0]=0,p[1]=0,p}function P(d,p,M){const t=M??new w(2),u=d[0],s=d[1];return t[0]=u*p[0]+s*p[4]+p[12],t[1]=u*p[1]+s*p[5]+p[13],t}function l(d,p,M){const t=M??new w(2),u=d[0],s=d[1];return t[0]=p[0]*u+p[4]*s+p[8],t[1]=p[1]*u+p[5]*s+p[9],t}function n(d,p,M,t){const u=t??new w(2),s=d[0]-p[0],c=d[1]-p[1],e=Math.sin(M),r=Math.cos(M);return u[0]=s*r-c*e+p[0],u[1]=s*e+c*r+p[1],u}function i(d,p,M){const t=M??new w(2);return lt(d,t),nt(t,p,t)}function o(d,p,M){const t=M??new w(2);return C(d)>p?i(d,p,t):j(d,t)}function a(d,p,M){const t=M??new w(2);return xt(d,p,.5,t)}return{create:x,fromValues:U,set:L,ceil:E,floor:O,round:Z,clamp:J,add:$,addScaled:at,angle:N,subtract:m,sub:b,equalsApproximately:Mt,equals:St,lerp:xt,lerpV:Et,max:Gt,min:Dt,mulScalar:nt,scale:Ut,divScalar:Pt,inverse:Bt,invert:_t,cross:zt,dot:At,length:C,len:Lt,lengthSq:ft,lenSq:Ot,distance:et,dist:R,distanceSq:k,distSq:I,normalize:lt,negate:It,copy:j,clone:Rt,multiply:yt,mul:kt,divide:gt,div:Ft,random:Vt,zero:D,transformMat4:P,transformMat3:l,rotate:n,setLength:i,truncate:o,midpoint:a}}const wn=new Map;function Dn(w){let x=wn.get(w);return x||(x=qn(w),wn.set(w,x)),x}function En(w){function x(e,r,h){const f=new w(3);return e!==void 0&&(f[0]=e,r!==void 0&&(f[1]=r,h!==void 0&&(f[2]=h))),f}const U=x;function L(e,r,h,f){const y=f??new w(3);return y[0]=e,y[1]=r,y[2]=h,y}function E(e,r){const h=r??new w(3);return h[0]=Math.ceil(e[0]),h[1]=Math.ceil(e[1]),h[2]=Math.ceil(e[2]),h}function O(e,r){const h=r??new w(3);return h[0]=Math.floor(e[0]),h[1]=Math.floor(e[1]),h[2]=Math.floor(e[2]),h}function Z(e,r){const h=r??new w(3);return h[0]=Math.round(e[0]),h[1]=Math.round(e[1]),h[2]=Math.round(e[2]),h}function J(e,r=0,h=1,f){const y=f??new w(3);return y[0]=Math.min(h,Math.max(r,e[0])),y[1]=Math.min(h,Math.max(r,e[1])),y[2]=Math.min(h,Math.max(r,e[2])),y}function $(e,r,h){const f=h??new w(3);return f[0]=e[0]+r[0],f[1]=e[1]+r[1],f[2]=e[2]+r[2],f}function at(e,r,h,f){const y=f??new w(3);return y[0]=e[0]+r[0]*h,y[1]=e[1]+r[1]*h,y[2]=e[2]+r[2]*h,y}function N(e,r){const h=e[0],f=e[1],y=e[2],g=r[0],S=r[1],A=r[2],B=Math.sqrt(h*h+f*f+y*y),z=Math.sqrt(g*g+S*S+A*A),T=B*z,_=T&&At(e,r)/T;return Math.acos(_)}function m(e,r,h){const f=h??new w(3);return f[0]=e[0]-r[0],f[1]=e[1]-r[1],f[2]=e[2]-r[2],f}const b=m;function Mt(e,r){return Math.abs(e[0]-r[0])<F&&Math.abs(e[1]-r[1])<F&&Math.abs(e[2]-r[2])<F}function St(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]}function xt(e,r,h,f){const y=f??new w(3);return y[0]=e[0]+h*(r[0]-e[0]),y[1]=e[1]+h*(r[1]-e[1]),y[2]=e[2]+h*(r[2]-e[2]),y}function Et(e,r,h,f){const y=f??new w(3);return y[0]=e[0]+h[0]*(r[0]-e[0]),y[1]=e[1]+h[1]*(r[1]-e[1]),y[2]=e[2]+h[2]*(r[2]-e[2]),y}function Gt(e,r,h){const f=h??new w(3);return f[0]=Math.max(e[0],r[0]),f[1]=Math.max(e[1],r[1]),f[2]=Math.max(e[2],r[2]),f}function Dt(e,r,h){const f=h??new w(3);return f[0]=Math.min(e[0],r[0]),f[1]=Math.min(e[1],r[1]),f[2]=Math.min(e[2],r[2]),f}function nt(e,r,h){const f=h??new w(3);return f[0]=e[0]*r,f[1]=e[1]*r,f[2]=e[2]*r,f}const Ut=nt;function Pt(e,r,h){const f=h??new w(3);return f[0]=e[0]/r,f[1]=e[1]/r,f[2]=e[2]/r,f}function Bt(e,r){const h=r??new w(3);return h[0]=1/e[0],h[1]=1/e[1],h[2]=1/e[2],h}const _t=Bt;function zt(e,r,h){const f=h??new w(3),y=e[2]*r[0]-e[0]*r[2],g=e[0]*r[1]-e[1]*r[0];return f[0]=e[1]*r[2]-e[2]*r[1],f[1]=y,f[2]=g,f}function At(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function C(e){const r=e[0],h=e[1],f=e[2];return Math.sqrt(r*r+h*h+f*f)}const Lt=C;function ft(e){const r=e[0],h=e[1],f=e[2];return r*r+h*h+f*f}const Ot=ft;function et(e,r){const h=e[0]-r[0],f=e[1]-r[1],y=e[2]-r[2];return Math.sqrt(h*h+f*f+y*y)}const R=et;function k(e,r){const h=e[0]-r[0],f=e[1]-r[1],y=e[2]-r[2];return h*h+f*f+y*y}const I=k;function lt(e,r){const h=r??new w(3),f=e[0],y=e[1],g=e[2],S=Math.sqrt(f*f+y*y+g*g);return S>1e-5?(h[0]=f/S,h[1]=y/S,h[2]=g/S):(h[0]=0,h[1]=0,h[2]=0),h}function It(e,r){const h=r??new w(3);return h[0]=-e[0],h[1]=-e[1],h[2]=-e[2],h}function j(e,r){const h=r??new w(3);return h[0]=e[0],h[1]=e[1],h[2]=e[2],h}const Rt=j;function yt(e,r,h){const f=h??new w(3);return f[0]=e[0]*r[0],f[1]=e[1]*r[1],f[2]=e[2]*r[2],f}const kt=yt;function gt(e,r,h){const f=h??new w(3);return f[0]=e[0]/r[0],f[1]=e[1]/r[1],f[2]=e[2]/r[2],f}const Ft=gt;function Vt(e=1,r){const h=r??new w(3),f=Math.random()*2*Math.PI,y=Math.random()*2-1,g=Math.sqrt(1-y*y)*e;return h[0]=Math.cos(f)*g,h[1]=Math.sin(f)*g,h[2]=y*e,h}function D(e){const r=e??new w(3);return r[0]=0,r[1]=0,r[2]=0,r}function P(e,r,h){const f=h??new w(3),y=e[0],g=e[1],S=e[2],A=r[3]*y+r[7]*g+r[11]*S+r[15]||1;return f[0]=(r[0]*y+r[4]*g+r[8]*S+r[12])/A,f[1]=(r[1]*y+r[5]*g+r[9]*S+r[13])/A,f[2]=(r[2]*y+r[6]*g+r[10]*S+r[14])/A,f}function l(e,r,h){const f=h??new w(3),y=e[0],g=e[1],S=e[2];return f[0]=y*r[0]+g*r[4]+S*r[8],f[1]=y*r[1]+g*r[5]+S*r[9],f[2]=y*r[2]+g*r[6]+S*r[10],f}function n(e,r,h){const f=h??new w(3),y=e[0],g=e[1],S=e[2];return f[0]=y*r[0]+g*r[4]+S*r[8],f[1]=y*r[1]+g*r[5]+S*r[9],f[2]=y*r[2]+g*r[6]+S*r[10],f}function i(e,r,h){const f=h??new w(3),y=r[0],g=r[1],S=r[2],A=r[3]*2,B=e[0],z=e[1],T=e[2],_=g*T-S*z,q=S*B-y*T,G=y*z-g*B;return f[0]=B+_*A+(g*G-S*q)*2,f[1]=z+q*A+(S*_-y*G)*2,f[2]=T+G*A+(y*q-g*_)*2,f}function o(e,r){const h=r??new w(3);return h[0]=e[12],h[1]=e[13],h[2]=e[14],h}function a(e,r,h){const f=h??new w(3),y=r*4;return f[0]=e[y+0],f[1]=e[y+1],f[2]=e[y+2],f}function d(e,r){const h=r??new w(3),f=e[0],y=e[1],g=e[2],S=e[4],A=e[5],B=e[6],z=e[8],T=e[9],_=e[10];return h[0]=Math.sqrt(f*f+y*y+g*g),h[1]=Math.sqrt(S*S+A*A+B*B),h[2]=Math.sqrt(z*z+T*T+_*_),h}function p(e,r,h,f){const y=f??new w(3),g=[],S=[];return g[0]=e[0]-r[0],g[1]=e[1]-r[1],g[2]=e[2]-r[2],S[0]=g[0],S[1]=g[1]*Math.cos(h)-g[2]*Math.sin(h),S[2]=g[1]*Math.sin(h)+g[2]*Math.cos(h),y[0]=S[0]+r[0],y[1]=S[1]+r[1],y[2]=S[2]+r[2],y}function M(e,r,h,f){const y=f??new w(3),g=[],S=[];return g[0]=e[0]-r[0],g[1]=e[1]-r[1],g[2]=e[2]-r[2],S[0]=g[2]*Math.sin(h)+g[0]*Math.cos(h),S[1]=g[1],S[2]=g[2]*Math.cos(h)-g[0]*Math.sin(h),y[0]=S[0]+r[0],y[1]=S[1]+r[1],y[2]=S[2]+r[2],y}function t(e,r,h,f){const y=f??new w(3),g=[],S=[];return g[0]=e[0]-r[0],g[1]=e[1]-r[1],g[2]=e[2]-r[2],S[0]=g[0]*Math.cos(h)-g[1]*Math.sin(h),S[1]=g[0]*Math.sin(h)+g[1]*Math.cos(h),S[2]=g[2],y[0]=S[0]+r[0],y[1]=S[1]+r[1],y[2]=S[2]+r[2],y}function u(e,r,h){const f=h??new w(3);return lt(e,f),nt(f,r,f)}function s(e,r,h){const f=h??new w(3);return C(e)>r?u(e,r,f):j(e,f)}function c(e,r,h){const f=h??new w(3);return xt(e,r,.5,f)}return{create:x,fromValues:U,set:L,ceil:E,floor:O,round:Z,clamp:J,add:$,addScaled:at,angle:N,subtract:m,sub:b,equalsApproximately:Mt,equals:St,lerp:xt,lerpV:Et,max:Gt,min:Dt,mulScalar:nt,scale:Ut,divScalar:Pt,inverse:Bt,invert:_t,cross:zt,dot:At,length:C,len:Lt,lengthSq:ft,lenSq:Ot,distance:et,dist:R,distanceSq:k,distSq:I,normalize:lt,negate:It,copy:j,clone:Rt,multiply:yt,mul:kt,divide:gt,div:Ft,random:Vt,zero:D,transformMat4:P,transformMat4Upper3x3:l,transformMat3:n,transformQuat:i,getTranslation:o,getAxis:a,getScaling:d,rotateX:p,rotateY:M,rotateZ:t,setLength:u,truncate:s,midpoint:c}}const hn=new Map;function Ct(w){let x=hn.get(w);return x||(x=En(w),hn.set(w,x)),x}function Gn(w){const x=Dn(w),U=Ct(w);function L(n,i,o,a,d,p,M,t,u){const s=new w(12);return s[3]=0,s[7]=0,s[11]=0,n!==void 0&&(s[0]=n,i!==void 0&&(s[1]=i,o!==void 0&&(s[2]=o,a!==void 0&&(s[4]=a,d!==void 0&&(s[5]=d,p!==void 0&&(s[6]=p,M!==void 0&&(s[8]=M,t!==void 0&&(s[9]=t,u!==void 0&&(s[10]=u))))))))),s}function E(n,i,o,a,d,p,M,t,u,s){const c=s??new w(12);return c[0]=n,c[1]=i,c[2]=o,c[3]=0,c[4]=a,c[5]=d,c[6]=p,c[7]=0,c[8]=M,c[9]=t,c[10]=u,c[11]=0,c}function O(n,i){const o=i??new w(12);return o[0]=n[0],o[1]=n[1],o[2]=n[2],o[3]=0,o[4]=n[4],o[5]=n[5],o[6]=n[6],o[7]=0,o[8]=n[8],o[9]=n[9],o[10]=n[10],o[11]=0,o}function Z(n,i){const o=i??new w(12),a=n[0],d=n[1],p=n[2],M=n[3],t=a+a,u=d+d,s=p+p,c=a*t,e=d*t,r=d*u,h=p*t,f=p*u,y=p*s,g=M*t,S=M*u,A=M*s;return o[0]=1-r-y,o[1]=e+A,o[2]=h-S,o[3]=0,o[4]=e-A,o[5]=1-c-y,o[6]=f+g,o[7]=0,o[8]=h+S,o[9]=f-g,o[10]=1-c-r,o[11]=0,o}function J(n,i){const o=i??new w(12);return o[0]=-n[0],o[1]=-n[1],o[2]=-n[2],o[4]=-n[4],o[5]=-n[5],o[6]=-n[6],o[8]=-n[8],o[9]=-n[9],o[10]=-n[10],o}function $(n,i,o){const a=o??new w(12);return a[0]=n[0]*i,a[1]=n[1]*i,a[2]=n[2]*i,a[4]=n[4]*i,a[5]=n[5]*i,a[6]=n[6]*i,a[8]=n[8]*i,a[9]=n[9]*i,a[10]=n[10]*i,a}const at=$;function N(n,i,o){const a=o??new w(12);return a[0]=n[0]+i[0],a[1]=n[1]+i[1],a[2]=n[2]+i[2],a[4]=n[4]+i[4],a[5]=n[5]+i[5],a[6]=n[6]+i[6],a[8]=n[8]+i[8],a[9]=n[9]+i[9],a[10]=n[10]+i[10],a}function m(n,i){const o=i??new w(12);return o[0]=n[0],o[1]=n[1],o[2]=n[2],o[4]=n[4],o[5]=n[5],o[6]=n[6],o[8]=n[8],o[9]=n[9],o[10]=n[10],o}const b=m;function Mt(n,i){return Math.abs(n[0]-i[0])<F&&Math.abs(n[1]-i[1])<F&&Math.abs(n[2]-i[2])<F&&Math.abs(n[4]-i[4])<F&&Math.abs(n[5]-i[5])<F&&Math.abs(n[6]-i[6])<F&&Math.abs(n[8]-i[8])<F&&Math.abs(n[9]-i[9])<F&&Math.abs(n[10]-i[10])<F}function St(n,i){return n[0]===i[0]&&n[1]===i[1]&&n[2]===i[2]&&n[4]===i[4]&&n[5]===i[5]&&n[6]===i[6]&&n[8]===i[8]&&n[9]===i[9]&&n[10]===i[10]}function xt(n){const i=n??new w(12);return i[0]=1,i[1]=0,i[2]=0,i[4]=0,i[5]=1,i[6]=0,i[8]=0,i[9]=0,i[10]=1,i}function Et(n,i){const o=i??new w(12);if(o===n){let r;return r=n[1],n[1]=n[4],n[4]=r,r=n[2],n[2]=n[8],n[8]=r,r=n[6],n[6]=n[9],n[9]=r,o}const a=n[0],d=n[1],p=n[2],M=n[4],t=n[5],u=n[6],s=n[8],c=n[9],e=n[10];return o[0]=a,o[1]=M,o[2]=s,o[4]=d,o[5]=t,o[6]=c,o[8]=p,o[9]=u,o[10]=e,o}function Gt(n,i){const o=i??new w(12),a=n[0],d=n[1],p=n[2],M=n[4],t=n[5],u=n[6],s=n[8],c=n[9],e=n[10],r=e*t-u*c,h=-e*M+u*s,f=c*M-t*s,y=1/(a*r+d*h+p*f);return o[0]=r*y,o[1]=(-e*d+p*c)*y,o[2]=(u*d-p*t)*y,o[4]=h*y,o[5]=(e*a-p*s)*y,o[6]=(-u*a+p*M)*y,o[8]=f*y,o[9]=(-c*a+d*s)*y,o[10]=(t*a-d*M)*y,o}function Dt(n){const i=n[0],o=n[1],a=n[2],d=n[4],p=n[5],M=n[6],t=n[8],u=n[9],s=n[10];return i*(p*s-u*M)-d*(o*s-u*a)+t*(o*M-p*a)}const nt=Gt;function Ut(n,i,o){const a=o??new w(12),d=n[0],p=n[1],M=n[2],t=n[4],u=n[5],s=n[6],c=n[8],e=n[9],r=n[10],h=i[0],f=i[1],y=i[2],g=i[4],S=i[5],A=i[6],B=i[8],z=i[9],T=i[10];return a[0]=d*h+t*f+c*y,a[1]=p*h+u*f+e*y,a[2]=M*h+s*f+r*y,a[4]=d*g+t*S+c*A,a[5]=p*g+u*S+e*A,a[6]=M*g+s*S+r*A,a[8]=d*B+t*z+c*T,a[9]=p*B+u*z+e*T,a[10]=M*B+s*z+r*T,a}const Pt=Ut;function Bt(n,i,o){const a=o??xt();return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[4]=n[4],a[5]=n[5],a[6]=n[6]),a[8]=i[0],a[9]=i[1],a[10]=1,a}function _t(n,i){const o=i??x.create();return o[0]=n[8],o[1]=n[9],o}function zt(n,i,o){const a=o??x.create(),d=i*4;return a[0]=n[d+0],a[1]=n[d+1],a}function At(n,i,o,a){const d=a===n?n:m(n,a),p=o*4;return d[p+0]=i[0],d[p+1]=i[1],d}function C(n,i){const o=i??x.create(),a=n[0],d=n[1],p=n[4],M=n[5];return o[0]=Math.sqrt(a*a+d*d),o[1]=Math.sqrt(p*p+M*M),o}function Lt(n,i){const o=i??U.create(),a=n[0],d=n[1],p=n[2],M=n[4],t=n[5],u=n[6],s=n[8],c=n[9],e=n[10];return o[0]=Math.sqrt(a*a+d*d+p*p),o[1]=Math.sqrt(M*M+t*t+u*u),o[2]=Math.sqrt(s*s+c*c+e*e),o}function ft(n,i){const o=i??new w(12);return o[0]=1,o[1]=0,o[2]=0,o[4]=0,o[5]=1,o[6]=0,o[8]=n[0],o[9]=n[1],o[10]=1,o}function Ot(n,i,o){const a=o??new w(12),d=i[0],p=i[1],M=n[0],t=n[1],u=n[2],s=n[4],c=n[5],e=n[6],r=n[8],h=n[9],f=n[10];return n!==a&&(a[0]=M,a[1]=t,a[2]=u,a[4]=s,a[5]=c,a[6]=e),a[8]=M*d+s*p+r,a[9]=t*d+c*p+h,a[10]=u*d+e*p+f,a}function et(n,i){const o=i??new w(12),a=Math.cos(n),d=Math.sin(n);return o[0]=a,o[1]=d,o[2]=0,o[4]=-d,o[5]=a,o[6]=0,o[8]=0,o[9]=0,o[10]=1,o}function R(n,i,o){const a=o??new w(12),d=n[0],p=n[1],M=n[2],t=n[4],u=n[5],s=n[6],c=Math.cos(i),e=Math.sin(i);return a[0]=c*d+e*t,a[1]=c*p+e*u,a[2]=c*M+e*s,a[4]=c*t-e*d,a[5]=c*u-e*p,a[6]=c*s-e*M,n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10]),a}function k(n,i){const o=i??new w(12),a=Math.cos(n),d=Math.sin(n);return o[0]=1,o[1]=0,o[2]=0,o[4]=0,o[5]=a,o[6]=d,o[8]=0,o[9]=-d,o[10]=a,o}function I(n,i,o){const a=o??new w(12),d=n[4],p=n[5],M=n[6],t=n[8],u=n[9],s=n[10],c=Math.cos(i),e=Math.sin(i);return a[4]=c*d+e*t,a[5]=c*p+e*u,a[6]=c*M+e*s,a[8]=c*t-e*d,a[9]=c*u-e*p,a[10]=c*s-e*M,n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2]),a}function lt(n,i){const o=i??new w(12),a=Math.cos(n),d=Math.sin(n);return o[0]=a,o[1]=0,o[2]=-d,o[4]=0,o[5]=1,o[6]=0,o[8]=d,o[9]=0,o[10]=a,o}function It(n,i,o){const a=o??new w(12),d=n[0],p=n[1],M=n[2],t=n[8],u=n[9],s=n[10],c=Math.cos(i),e=Math.sin(i);return a[0]=c*d-e*t,a[1]=c*p-e*u,a[2]=c*M-e*s,a[8]=c*t+e*d,a[9]=c*u+e*p,a[10]=c*s+e*M,n!==a&&(a[4]=n[4],a[5]=n[5],a[6]=n[6]),a}const j=et,Rt=R;function yt(n,i){const o=i??new w(12);return o[0]=n[0],o[1]=0,o[2]=0,o[4]=0,o[5]=n[1],o[6]=0,o[8]=0,o[9]=0,o[10]=1,o}function kt(n,i,o){const a=o??new w(12),d=i[0],p=i[1];return a[0]=d*n[0],a[1]=d*n[1],a[2]=d*n[2],a[4]=p*n[4],a[5]=p*n[5],a[6]=p*n[6],n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10]),a}function gt(n,i){const o=i??new w(12);return o[0]=n[0],o[1]=0,o[2]=0,o[4]=0,o[5]=n[1],o[6]=0,o[8]=0,o[9]=0,o[10]=n[2],o}function Ft(n,i,o){const a=o??new w(12),d=i[0],p=i[1],M=i[2];return a[0]=d*n[0],a[1]=d*n[1],a[2]=d*n[2],a[4]=p*n[4],a[5]=p*n[5],a[6]=p*n[6],a[8]=M*n[8],a[9]=M*n[9],a[10]=M*n[10],a}function Vt(n,i){const o=i??new w(12);return o[0]=n,o[1]=0,o[2]=0,o[4]=0,o[5]=n,o[6]=0,o[8]=0,o[9]=0,o[10]=1,o}function D(n,i,o){const a=o??new w(12);return a[0]=i*n[0],a[1]=i*n[1],a[2]=i*n[2],a[4]=i*n[4],a[5]=i*n[5],a[6]=i*n[6],n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10]),a}function P(n,i){const o=i??new w(12);return o[0]=n,o[1]=0,o[2]=0,o[4]=0,o[5]=n,o[6]=0,o[8]=0,o[9]=0,o[10]=n,o}function l(n,i,o){const a=o??new w(12);return a[0]=i*n[0],a[1]=i*n[1],a[2]=i*n[2],a[4]=i*n[4],a[5]=i*n[5],a[6]=i*n[6],a[8]=i*n[8],a[9]=i*n[9],a[10]=i*n[10],a}return{add:N,clone:b,copy:m,create:L,determinant:Dt,equals:St,equalsApproximately:Mt,fromMat4:O,fromQuat:Z,get3DScaling:Lt,getAxis:zt,getScaling:C,getTranslation:_t,identity:xt,inverse:Gt,invert:nt,mul:Pt,mulScalar:at,multiply:Ut,multiplyScalar:$,negate:J,rotate:R,rotateX:I,rotateY:It,rotateZ:Rt,rotation:et,rotationX:k,rotationY:lt,rotationZ:j,scale:kt,scale3D:Ft,scaling:yt,scaling3D:gt,set:E,setAxis:At,setTranslation:Bt,translate:Ot,translation:ft,transpose:Et,uniformScale:D,uniformScale3D:l,uniformScaling:Vt,uniformScaling3D:P}}const dn=new Map;function Un(w){let x=dn.get(w);return x||(x=Gn(w),dn.set(w,x)),x}function _n(w){const x=Ct(w);function U(t,u,s,c,e,r,h,f,y,g,S,A,B,z,T,_){const q=new w(16);return t!==void 0&&(q[0]=t,u!==void 0&&(q[1]=u,s!==void 0&&(q[2]=s,c!==void 0&&(q[3]=c,e!==void 0&&(q[4]=e,r!==void 0&&(q[5]=r,h!==void 0&&(q[6]=h,f!==void 0&&(q[7]=f,y!==void 0&&(q[8]=y,g!==void 0&&(q[9]=g,S!==void 0&&(q[10]=S,A!==void 0&&(q[11]=A,B!==void 0&&(q[12]=B,z!==void 0&&(q[13]=z,T!==void 0&&(q[14]=T,_!==void 0&&(q[15]=_)))))))))))))))),q}function L(t,u,s,c,e,r,h,f,y,g,S,A,B,z,T,_,q){const G=q??new w(16);return G[0]=t,G[1]=u,G[2]=s,G[3]=c,G[4]=e,G[5]=r,G[6]=h,G[7]=f,G[8]=y,G[9]=g,G[10]=S,G[11]=A,G[12]=B,G[13]=z,G[14]=T,G[15]=_,G}function E(t,u){const s=u??new w(16);return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=0,s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=0,s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function O(t,u){const s=u??new w(16),c=t[0],e=t[1],r=t[2],h=t[3],f=c+c,y=e+e,g=r+r,S=c*f,A=e*f,B=e*y,z=r*f,T=r*y,_=r*g,q=h*f,G=h*y,Y=h*g;return s[0]=1-B-_,s[1]=A+Y,s[2]=z-G,s[3]=0,s[4]=A-Y,s[5]=1-S-_,s[6]=T+q,s[7]=0,s[8]=z+G,s[9]=T-q,s[10]=1-S-B,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Z(t,u){const s=u??new w(16);return s[0]=-t[0],s[1]=-t[1],s[2]=-t[2],s[3]=-t[3],s[4]=-t[4],s[5]=-t[5],s[6]=-t[6],s[7]=-t[7],s[8]=-t[8],s[9]=-t[9],s[10]=-t[10],s[11]=-t[11],s[12]=-t[12],s[13]=-t[13],s[14]=-t[14],s[15]=-t[15],s}function J(t,u,s){const c=s??new w(16);return c[0]=t[0]+u[0],c[1]=t[1]+u[1],c[2]=t[2]+u[2],c[3]=t[3]+u[3],c[4]=t[4]+u[4],c[5]=t[5]+u[5],c[6]=t[6]+u[6],c[7]=t[7]+u[7],c[8]=t[8]+u[8],c[9]=t[9]+u[9],c[10]=t[10]+u[10],c[11]=t[11]+u[11],c[12]=t[12]+u[12],c[13]=t[13]+u[13],c[14]=t[14]+u[14],c[15]=t[15]+u[15],c}function $(t,u,s){const c=s??new w(16);return c[0]=t[0]*u,c[1]=t[1]*u,c[2]=t[2]*u,c[3]=t[3]*u,c[4]=t[4]*u,c[5]=t[5]*u,c[6]=t[6]*u,c[7]=t[7]*u,c[8]=t[8]*u,c[9]=t[9]*u,c[10]=t[10]*u,c[11]=t[11]*u,c[12]=t[12]*u,c[13]=t[13]*u,c[14]=t[14]*u,c[15]=t[15]*u,c}const at=$;function N(t,u){const s=u??new w(16);return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s}const m=N;function b(t,u){return Math.abs(t[0]-u[0])<F&&Math.abs(t[1]-u[1])<F&&Math.abs(t[2]-u[2])<F&&Math.abs(t[3]-u[3])<F&&Math.abs(t[4]-u[4])<F&&Math.abs(t[5]-u[5])<F&&Math.abs(t[6]-u[6])<F&&Math.abs(t[7]-u[7])<F&&Math.abs(t[8]-u[8])<F&&Math.abs(t[9]-u[9])<F&&Math.abs(t[10]-u[10])<F&&Math.abs(t[11]-u[11])<F&&Math.abs(t[12]-u[12])<F&&Math.abs(t[13]-u[13])<F&&Math.abs(t[14]-u[14])<F&&Math.abs(t[15]-u[15])<F}function Mt(t,u){return t[0]===u[0]&&t[1]===u[1]&&t[2]===u[2]&&t[3]===u[3]&&t[4]===u[4]&&t[5]===u[5]&&t[6]===u[6]&&t[7]===u[7]&&t[8]===u[8]&&t[9]===u[9]&&t[10]===u[10]&&t[11]===u[11]&&t[12]===u[12]&&t[13]===u[13]&&t[14]===u[14]&&t[15]===u[15]}function St(t){const u=t??new w(16);return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function xt(t,u){const s=u??new w(16);if(s===t){let X;return X=t[1],t[1]=t[4],t[4]=X,X=t[2],t[2]=t[8],t[8]=X,X=t[3],t[3]=t[12],t[12]=X,X=t[6],t[6]=t[9],t[9]=X,X=t[7],t[7]=t[13],t[13]=X,X=t[11],t[11]=t[14],t[14]=X,s}const c=t[0],e=t[1],r=t[2],h=t[3],f=t[4],y=t[5],g=t[6],S=t[7],A=t[8],B=t[9],z=t[10],T=t[11],_=t[12],q=t[13],G=t[14],Y=t[15];return s[0]=c,s[1]=f,s[2]=A,s[3]=_,s[4]=e,s[5]=y,s[6]=B,s[7]=q,s[8]=r,s[9]=g,s[10]=z,s[11]=G,s[12]=h,s[13]=S,s[14]=T,s[15]=Y,s}function Et(t,u){const s=u??new w(16),c=t[0],e=t[1],r=t[2],h=t[3],f=t[4],y=t[5],g=t[6],S=t[7],A=t[8],B=t[9],z=t[10],T=t[11],_=t[12],q=t[13],G=t[14],Y=t[15],X=z*Y,H=G*T,W=g*Y,Q=G*S,tt=g*T,st=z*S,ot=r*Y,ct=G*h,rt=r*T,it=z*h,wt=r*S,ht=g*h,dt=A*q,pt=_*B,vt=f*q,Tt=_*y,qt=f*B,Nt=A*y,mt=c*q,Ht=_*e,Wt=c*B,Qt=A*e,Kt=c*y,Jt=f*e,un=X*y+Q*B+tt*q-(H*y+W*B+st*q),an=H*e+ot*B+it*q-(X*e+ct*B+rt*q),fn=W*e+ct*y+wt*q-(Q*e+ot*y+ht*q),ln=st*e+rt*y+ht*B-(tt*e+it*y+wt*B),ut=1/(c*un+f*an+A*fn+_*ln);return s[0]=ut*un,s[1]=ut*an,s[2]=ut*fn,s[3]=ut*ln,s[4]=ut*(H*f+W*A+st*_-(X*f+Q*A+tt*_)),s[5]=ut*(X*c+ct*A+rt*_-(H*c+ot*A+it*_)),s[6]=ut*(Q*c+ot*f+ht*_-(W*c+ct*f+wt*_)),s[7]=ut*(tt*c+it*f+wt*A-(st*c+rt*f+ht*A)),s[8]=ut*(dt*S+Tt*T+qt*Y-(pt*S+vt*T+Nt*Y)),s[9]=ut*(pt*h+mt*T+Qt*Y-(dt*h+Ht*T+Wt*Y)),s[10]=ut*(vt*h+Ht*S+Kt*Y-(Tt*h+mt*S+Jt*Y)),s[11]=ut*(Nt*h+Wt*S+Jt*T-(qt*h+Qt*S+Kt*T)),s[12]=ut*(vt*z+Nt*G+pt*g-(qt*G+dt*g+Tt*z)),s[13]=ut*(Wt*G+dt*r+Ht*z-(mt*z+Qt*G+pt*r)),s[14]=ut*(mt*g+Jt*G+Tt*r-(Kt*G+vt*r+Ht*g)),s[15]=ut*(Kt*z+qt*r+Qt*g-(Wt*g+Jt*z+Nt*r)),s}function Gt(t){const u=t[0],s=t[1],c=t[2],e=t[3],r=t[4],h=t[5],f=t[6],y=t[7],g=t[8],S=t[9],A=t[10],B=t[11],z=t[12],T=t[13],_=t[14],q=t[15],G=A*q,Y=_*B,X=f*q,H=_*y,W=f*B,Q=A*y,tt=c*q,st=_*e,ot=c*B,ct=A*e,rt=c*y,it=f*e,wt=G*h+H*S+W*T-(Y*h+X*S+Q*T),ht=Y*s+tt*S+ct*T-(G*s+st*S+ot*T),dt=X*s+st*h+rt*T-(H*s+tt*h+it*T),pt=Q*s+ot*h+it*S-(W*s+ct*h+rt*S);return u*wt+r*ht+g*dt+z*pt}const Dt=Et;function nt(t,u,s){const c=s??new w(16),e=t[0],r=t[1],h=t[2],f=t[3],y=t[4],g=t[5],S=t[6],A=t[7],B=t[8],z=t[9],T=t[10],_=t[11],q=t[12],G=t[13],Y=t[14],X=t[15],H=u[0],W=u[1],Q=u[2],tt=u[3],st=u[4],ot=u[5],ct=u[6],rt=u[7],it=u[8],wt=u[9],ht=u[10],dt=u[11],pt=u[12],vt=u[13],Tt=u[14],qt=u[15];return c[0]=e*H+y*W+B*Q+q*tt,c[1]=r*H+g*W+z*Q+G*tt,c[2]=h*H+S*W+T*Q+Y*tt,c[3]=f*H+A*W+_*Q+X*tt,c[4]=e*st+y*ot+B*ct+q*rt,c[5]=r*st+g*ot+z*ct+G*rt,c[6]=h*st+S*ot+T*ct+Y*rt,c[7]=f*st+A*ot+_*ct+X*rt,c[8]=e*it+y*wt+B*ht+q*dt,c[9]=r*it+g*wt+z*ht+G*dt,c[10]=h*it+S*wt+T*ht+Y*dt,c[11]=f*it+A*wt+_*ht+X*dt,c[12]=e*pt+y*vt+B*Tt+q*qt,c[13]=r*pt+g*vt+z*Tt+G*qt,c[14]=h*pt+S*vt+T*Tt+Y*qt,c[15]=f*pt+A*vt+_*Tt+X*qt,c}const Ut=nt;function Pt(t,u,s){const c=s??St();return t!==c&&(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[8]=t[8],c[9]=t[9],c[10]=t[10],c[11]=t[11]),c[12]=u[0],c[13]=u[1],c[14]=u[2],c[15]=1,c}function Bt(t,u){const s=u??x.create();return s[0]=t[12],s[1]=t[13],s[2]=t[14],s}function _t(t,u,s){const c=s??x.create(),e=u*4;return c[0]=t[e+0],c[1]=t[e+1],c[2]=t[e+2],c}function zt(t,u,s,c){const e=c===t?c:N(t,c),r=s*4;return e[r+0]=u[0],e[r+1]=u[1],e[r+2]=u[2],e}function At(t,u){const s=u??x.create(),c=t[0],e=t[1],r=t[2],h=t[4],f=t[5],y=t[6],g=t[8],S=t[9],A=t[10];return s[0]=Math.sqrt(c*c+e*e+r*r),s[1]=Math.sqrt(h*h+f*f+y*y),s[2]=Math.sqrt(g*g+S*S+A*A),s}function C(t,u,s,c,e){const r=e??new w(16),h=Math.tan(Math.PI*.5-.5*t);if(r[0]=h/u,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=h,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,Number.isFinite(c)){const f=1/(s-c);r[10]=c*f,r[14]=c*s*f}else r[10]=-1,r[14]=-s;return r}function Lt(t,u,s,c=1/0,e){const r=e??new w(16),h=1/Math.tan(t*.5);if(r[0]=h/u,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=h,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,c===1/0)r[10]=0,r[14]=s;else{const f=1/(c-s);r[10]=s*f,r[14]=c*s*f}return r}function ft(t,u,s,c,e,r,h){const f=h??new w(16);return f[0]=2/(u-t),f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=2/(c-s),f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1/(e-r),f[11]=0,f[12]=(u+t)/(t-u),f[13]=(c+s)/(s-c),f[14]=e/(e-r),f[15]=1,f}function Ot(t,u,s,c,e,r,h){const f=h??new w(16),y=u-t,g=c-s,S=e-r;return f[0]=2*e/y,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=2*e/g,f[6]=0,f[7]=0,f[8]=(t+u)/y,f[9]=(c+s)/g,f[10]=r/S,f[11]=-1,f[12]=0,f[13]=0,f[14]=e*r/S,f[15]=0,f}function et(t,u,s,c,e,r=1/0,h){const f=h??new w(16),y=u-t,g=c-s;if(f[0]=2*e/y,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=2*e/g,f[6]=0,f[7]=0,f[8]=(t+u)/y,f[9]=(c+s)/g,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,r===1/0)f[10]=0,f[14]=e;else{const S=1/(r-e);f[10]=e*S,f[14]=r*e*S}return f}const R=x.create(),k=x.create(),I=x.create();function lt(t,u,s,c){const e=c??new w(16);return x.normalize(x.subtract(u,t,I),I),x.normalize(x.cross(s,I,R),R),x.normalize(x.cross(I,R,k),k),e[0]=R[0],e[1]=R[1],e[2]=R[2],e[3]=0,e[4]=k[0],e[5]=k[1],e[6]=k[2],e[7]=0,e[8]=I[0],e[9]=I[1],e[10]=I[2],e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function It(t,u,s,c){const e=c??new w(16);return x.normalize(x.subtract(t,u,I),I),x.normalize(x.cross(s,I,R),R),x.normalize(x.cross(I,R,k),k),e[0]=R[0],e[1]=R[1],e[2]=R[2],e[3]=0,e[4]=k[0],e[5]=k[1],e[6]=k[2],e[7]=0,e[8]=I[0],e[9]=I[1],e[10]=I[2],e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function j(t,u,s,c){const e=c??new w(16);return x.normalize(x.subtract(t,u,I),I),x.normalize(x.cross(s,I,R),R),x.normalize(x.cross(I,R,k),k),e[0]=R[0],e[1]=k[0],e[2]=I[0],e[3]=0,e[4]=R[1],e[5]=k[1],e[6]=I[1],e[7]=0,e[8]=R[2],e[9]=k[2],e[10]=I[2],e[11]=0,e[12]=-(R[0]*t[0]+R[1]*t[1]+R[2]*t[2]),e[13]=-(k[0]*t[0]+k[1]*t[1]+k[2]*t[2]),e[14]=-(I[0]*t[0]+I[1]*t[1]+I[2]*t[2]),e[15]=1,e}function Rt(t,u){const s=u??new w(16);return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=t[0],s[13]=t[1],s[14]=t[2],s[15]=1,s}function yt(t,u,s){const c=s??new w(16),e=u[0],r=u[1],h=u[2],f=t[0],y=t[1],g=t[2],S=t[3],A=t[4],B=t[5],z=t[6],T=t[7],_=t[8],q=t[9],G=t[10],Y=t[11],X=t[12],H=t[13],W=t[14],Q=t[15];return t!==c&&(c[0]=f,c[1]=y,c[2]=g,c[3]=S,c[4]=A,c[5]=B,c[6]=z,c[7]=T,c[8]=_,c[9]=q,c[10]=G,c[11]=Y),c[12]=f*e+A*r+_*h+X,c[13]=y*e+B*r+q*h+H,c[14]=g*e+z*r+G*h+W,c[15]=S*e+T*r+Y*h+Q,c}function kt(t,u){const s=u??new w(16),c=Math.cos(t),e=Math.sin(t);return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=c,s[6]=e,s[7]=0,s[8]=0,s[9]=-e,s[10]=c,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function gt(t,u,s){const c=s??new w(16),e=t[4],r=t[5],h=t[6],f=t[7],y=t[8],g=t[9],S=t[10],A=t[11],B=Math.cos(u),z=Math.sin(u);return c[4]=B*e+z*y,c[5]=B*r+z*g,c[6]=B*h+z*S,c[7]=B*f+z*A,c[8]=B*y-z*e,c[9]=B*g-z*r,c[10]=B*S-z*h,c[11]=B*A-z*f,t!==c&&(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15]),c}function Ft(t,u){const s=u??new w(16),c=Math.cos(t),e=Math.sin(t);return s[0]=c,s[1]=0,s[2]=-e,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=e,s[9]=0,s[10]=c,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Vt(t,u,s){const c=s??new w(16),e=t[0],r=t[1],h=t[2],f=t[3],y=t[8],g=t[9],S=t[10],A=t[11],B=Math.cos(u),z=Math.sin(u);return c[0]=B*e-z*y,c[1]=B*r-z*g,c[2]=B*h-z*S,c[3]=B*f-z*A,c[8]=B*y+z*e,c[9]=B*g+z*r,c[10]=B*S+z*h,c[11]=B*A+z*f,t!==c&&(c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15]),c}function D(t,u){const s=u??new w(16),c=Math.cos(t),e=Math.sin(t);return s[0]=c,s[1]=e,s[2]=0,s[3]=0,s[4]=-e,s[5]=c,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function P(t,u,s){const c=s??new w(16),e=t[0],r=t[1],h=t[2],f=t[3],y=t[4],g=t[5],S=t[6],A=t[7],B=Math.cos(u),z=Math.sin(u);return c[0]=B*e+z*y,c[1]=B*r+z*g,c[2]=B*h+z*S,c[3]=B*f+z*A,c[4]=B*y-z*e,c[5]=B*g-z*r,c[6]=B*S-z*h,c[7]=B*A-z*f,t!==c&&(c[8]=t[8],c[9]=t[9],c[10]=t[10],c[11]=t[11],c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15]),c}function l(t,u,s){const c=s??new w(16);let e=t[0],r=t[1],h=t[2];const f=Math.sqrt(e*e+r*r+h*h);e/=f,r/=f,h/=f;const y=e*e,g=r*r,S=h*h,A=Math.cos(u),B=Math.sin(u),z=1-A;return c[0]=y+(1-y)*A,c[1]=e*r*z+h*B,c[2]=e*h*z-r*B,c[3]=0,c[4]=e*r*z-h*B,c[5]=g+(1-g)*A,c[6]=r*h*z+e*B,c[7]=0,c[8]=e*h*z+r*B,c[9]=r*h*z-e*B,c[10]=S+(1-S)*A,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}const n=l;function i(t,u,s,c){const e=c??new w(16);let r=u[0],h=u[1],f=u[2];const y=Math.sqrt(r*r+h*h+f*f);r/=y,h/=y,f/=y;const g=r*r,S=h*h,A=f*f,B=Math.cos(s),z=Math.sin(s),T=1-B,_=g+(1-g)*B,q=r*h*T+f*z,G=r*f*T-h*z,Y=r*h*T-f*z,X=S+(1-S)*B,H=h*f*T+r*z,W=r*f*T+h*z,Q=h*f*T-r*z,tt=A+(1-A)*B,st=t[0],ot=t[1],ct=t[2],rt=t[3],it=t[4],wt=t[5],ht=t[6],dt=t[7],pt=t[8],vt=t[9],Tt=t[10],qt=t[11];return e[0]=_*st+q*it+G*pt,e[1]=_*ot+q*wt+G*vt,e[2]=_*ct+q*ht+G*Tt,e[3]=_*rt+q*dt+G*qt,e[4]=Y*st+X*it+H*pt,e[5]=Y*ot+X*wt+H*vt,e[6]=Y*ct+X*ht+H*Tt,e[7]=Y*rt+X*dt+H*qt,e[8]=W*st+Q*it+tt*pt,e[9]=W*ot+Q*wt+tt*vt,e[10]=W*ct+Q*ht+tt*Tt,e[11]=W*rt+Q*dt+tt*qt,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e}const o=i;function a(t,u){const s=u??new w(16);return s[0]=t[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=t[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=t[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function d(t,u,s){const c=s??new w(16),e=u[0],r=u[1],h=u[2];return c[0]=e*t[0],c[1]=e*t[1],c[2]=e*t[2],c[3]=e*t[3],c[4]=r*t[4],c[5]=r*t[5],c[6]=r*t[6],c[7]=r*t[7],c[8]=h*t[8],c[9]=h*t[9],c[10]=h*t[10],c[11]=h*t[11],t!==c&&(c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15]),c}function p(t,u){const s=u??new w(16);return s[0]=t,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=t,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=t,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function M(t,u,s){const c=s??new w(16);return c[0]=u*t[0],c[1]=u*t[1],c[2]=u*t[2],c[3]=u*t[3],c[4]=u*t[4],c[5]=u*t[5],c[6]=u*t[6],c[7]=u*t[7],c[8]=u*t[8],c[9]=u*t[9],c[10]=u*t[10],c[11]=u*t[11],t!==c&&(c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15]),c}return{add:J,aim:lt,axisRotate:i,axisRotation:l,cameraAim:It,clone:m,copy:N,create:U,determinant:Gt,equals:Mt,equalsApproximately:b,fromMat3:E,fromQuat:O,frustum:Ot,frustumReverseZ:et,getAxis:_t,getScaling:At,getTranslation:Bt,identity:St,inverse:Et,invert:Dt,lookAt:j,mul:Ut,mulScalar:at,multiply:nt,multiplyScalar:$,negate:Z,ortho:ft,perspective:C,perspectiveReverseZ:Lt,rotate:o,rotateX:gt,rotateY:Vt,rotateZ:P,rotation:n,rotationX:kt,rotationY:Ft,rotationZ:D,scale:d,scaling:a,set:L,setAxis:zt,setTranslation:Pt,translate:yt,translation:Rt,transpose:xt,uniformScale:M,uniformScaling:p}}const pn=new Map;function Fn(w){let x=pn.get(w);return x||(x=_n(w),pn.set(w,x)),x}function Vn(w){const x=Ct(w);function U(D,P,l,n){const i=new w(4);return D!==void 0&&(i[0]=D,P!==void 0&&(i[1]=P,l!==void 0&&(i[2]=l,n!==void 0&&(i[3]=n)))),i}const L=U;function E(D,P,l,n,i){const o=i??new w(4);return o[0]=D,o[1]=P,o[2]=l,o[3]=n,o}function O(D,P,l){const n=l??new w(4),i=P*.5,o=Math.sin(i);return n[0]=o*D[0],n[1]=o*D[1],n[2]=o*D[2],n[3]=Math.cos(i),n}function Z(D,P){const l=P??x.create(3),n=Math.acos(D[3])*2,i=Math.sin(n*.5);return i>F?(l[0]=D[0]/i,l[1]=D[1]/i,l[2]=D[2]/i):(l[0]=1,l[1]=0,l[2]=0),{angle:n,axis:l}}function J(D,P){const l=C(D,P);return Math.acos(2*l*l-1)}function $(D,P,l){const n=l??new w(4),i=D[0],o=D[1],a=D[2],d=D[3],p=P[0],M=P[1],t=P[2],u=P[3];return n[0]=i*u+d*p+o*t-a*M,n[1]=o*u+d*M+a*p-i*t,n[2]=a*u+d*t+i*M-o*p,n[3]=d*u-i*p-o*M-a*t,n}const at=$;function N(D,P,l){const n=l??new w(4),i=P*.5,o=D[0],a=D[1],d=D[2],p=D[3],M=Math.sin(i),t=Math.cos(i);return n[0]=o*t+p*M,n[1]=a*t+d*M,n[2]=d*t-a*M,n[3]=p*t-o*M,n}function m(D,P,l){const n=l??new w(4),i=P*.5,o=D[0],a=D[1],d=D[2],p=D[3],M=Math.sin(i),t=Math.cos(i);return n[0]=o*t-d*M,n[1]=a*t+p*M,n[2]=d*t+o*M,n[3]=p*t-a*M,n}function b(D,P,l){const n=l??new w(4),i=P*.5,o=D[0],a=D[1],d=D[2],p=D[3],M=Math.sin(i),t=Math.cos(i);return n[0]=o*t+a*M,n[1]=a*t-o*M,n[2]=d*t+p*M,n[3]=p*t-d*M,n}function Mt(D,P,l,n){const i=n??new w(4),o=D[0],a=D[1],d=D[2],p=D[3];let M=P[0],t=P[1],u=P[2],s=P[3],c=o*M+a*t+d*u+p*s;c<0&&(c=-c,M=-M,t=-t,u=-u,s=-s);let e,r;if(1-c>F){const h=Math.acos(c),f=Math.sin(h);e=Math.sin((1-l)*h)/f,r=Math.sin(l*h)/f}else e=1-l,r=l;return i[0]=e*o+r*M,i[1]=e*a+r*t,i[2]=e*d+r*u,i[3]=e*p+r*s,i}function St(D,P){const l=P??new w(4),n=D[0],i=D[1],o=D[2],a=D[3],d=n*n+i*i+o*o+a*a,p=d?1/d:0;return l[0]=-n*p,l[1]=-i*p,l[2]=-o*p,l[3]=a*p,l}function xt(D,P){const l=P??new w(4);return l[0]=-D[0],l[1]=-D[1],l[2]=-D[2],l[3]=D[3],l}function Et(D,P){const l=P??new w(4),n=D[0]+D[5]+D[10];if(n>0){const i=Math.sqrt(n+1);l[3]=.5*i;const o=.5/i;l[0]=(D[6]-D[9])*o,l[1]=(D[8]-D[2])*o,l[2]=(D[1]-D[4])*o}else{let i=0;D[5]>D[0]&&(i=1),D[10]>D[i*4+i]&&(i=2);const o=(i+1)%3,a=(i+2)%3,d=Math.sqrt(D[i*4+i]-D[o*4+o]-D[a*4+a]+1);l[i]=.5*d;const p=.5/d;l[3]=(D[o*4+a]-D[a*4+o])*p,l[o]=(D[o*4+i]+D[i*4+o])*p,l[a]=(D[a*4+i]+D[i*4+a])*p}return l}function Gt(D,P,l,n,i){const o=i??new w(4),a=D*.5,d=P*.5,p=l*.5,M=Math.sin(a),t=Math.cos(a),u=Math.sin(d),s=Math.cos(d),c=Math.sin(p),e=Math.cos(p);switch(n){case"xyz":o[0]=M*s*e+t*u*c,o[1]=t*u*e-M*s*c,o[2]=t*s*c+M*u*e,o[3]=t*s*e-M*u*c;break;case"xzy":o[0]=M*s*e-t*u*c,o[1]=t*u*e-M*s*c,o[2]=t*s*c+M*u*e,o[3]=t*s*e+M*u*c;break;case"yxz":o[0]=M*s*e+t*u*c,o[1]=t*u*e-M*s*c,o[2]=t*s*c-M*u*e,o[3]=t*s*e+M*u*c;break;case"yzx":o[0]=M*s*e+t*u*c,o[1]=t*u*e+M*s*c,o[2]=t*s*c-M*u*e,o[3]=t*s*e-M*u*c;break;case"zxy":o[0]=M*s*e-t*u*c,o[1]=t*u*e+M*s*c,o[2]=t*s*c+M*u*e,o[3]=t*s*e-M*u*c;break;case"zyx":o[0]=M*s*e-t*u*c,o[1]=t*u*e+M*s*c,o[2]=t*s*c-M*u*e,o[3]=t*s*e+M*u*c;break;default:throw new Error(`Unknown rotation order: ${n}`)}return o}function Dt(D,P){const l=P??new w(4);return l[0]=D[0],l[1]=D[1],l[2]=D[2],l[3]=D[3],l}const nt=Dt;function Ut(D,P,l){const n=l??new w(4);return n[0]=D[0]+P[0],n[1]=D[1]+P[1],n[2]=D[2]+P[2],n[3]=D[3]+P[3],n}function Pt(D,P,l){const n=l??new w(4);return n[0]=D[0]-P[0],n[1]=D[1]-P[1],n[2]=D[2]-P[2],n[3]=D[3]-P[3],n}const Bt=Pt;function _t(D,P,l){const n=l??new w(4);return n[0]=D[0]*P,n[1]=D[1]*P,n[2]=D[2]*P,n[3]=D[3]*P,n}const zt=_t;function At(D,P,l){const n=l??new w(4);return n[0]=D[0]/P,n[1]=D[1]/P,n[2]=D[2]/P,n[3]=D[3]/P,n}function C(D,P){return D[0]*P[0]+D[1]*P[1]+D[2]*P[2]+D[3]*P[3]}function Lt(D,P,l,n){const i=n??new w(4);return i[0]=D[0]+l*(P[0]-D[0]),i[1]=D[1]+l*(P[1]-D[1]),i[2]=D[2]+l*(P[2]-D[2]),i[3]=D[3]+l*(P[3]-D[3]),i}function ft(D){const P=D[0],l=D[1],n=D[2],i=D[3];return Math.sqrt(P*P+l*l+n*n+i*i)}const Ot=ft;function et(D){const P=D[0],l=D[1],n=D[2],i=D[3];return P*P+l*l+n*n+i*i}const R=et;function k(D,P){const l=P??new w(4),n=D[0],i=D[1],o=D[2],a=D[3],d=Math.sqrt(n*n+i*i+o*o+a*a);return d>1e-5?(l[0]=n/d,l[1]=i/d,l[2]=o/d,l[3]=a/d):(l[0]=0,l[1]=0,l[2]=0,l[3]=1),l}function I(D,P){return Math.abs(D[0]-P[0])<F&&Math.abs(D[1]-P[1])<F&&Math.abs(D[2]-P[2])<F&&Math.abs(D[3]-P[3])<F}function lt(D,P){return D[0]===P[0]&&D[1]===P[1]&&D[2]===P[2]&&D[3]===P[3]}function It(D){const P=D??new w(4);return P[0]=0,P[1]=0,P[2]=0,P[3]=1,P}const j=x.create(),Rt=x.create(),yt=x.create();function kt(D,P,l){const n=l??new w(4),i=x.dot(D,P);return i<-.999999?(x.cross(Rt,D,j),x.len(j)<1e-6&&x.cross(yt,D,j),x.normalize(j,j),O(j,Math.PI,n),n):i>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(x.cross(D,P,j),n[0]=j[0],n[1]=j[1],n[2]=j[2],n[3]=1+i,k(n,n))}const gt=new w(4),Ft=new w(4);function Vt(D,P,l,n,i,o){const a=o??new w(4);return Mt(D,n,i,gt),Mt(P,l,i,Ft),Mt(gt,Ft,2*i*(1-i),a),a}return{create:U,fromValues:L,set:E,fromAxisAngle:O,toAxisAngle:Z,angle:J,multiply:$,mul:at,rotateX:N,rotateY:m,rotateZ:b,slerp:Mt,inverse:St,conjugate:xt,fromMat:Et,fromEuler:Gt,copy:Dt,clone:nt,add:Ut,subtract:Pt,sub:Bt,mulScalar:_t,scale:zt,divScalar:At,dot:C,lerp:Lt,length:ft,len:Ot,lengthSq:et,lenSq:R,normalize:k,equalsApproximately:I,equals:lt,identity:It,rotationTo:kt,sqlerp:Vt}}const Mn=new Map;function Ln(w){let x=Mn.get(w);return x||(x=Vn(w),Mn.set(w,x)),x}function On(w){function x(l,n,i,o){const a=new w(4);return l!==void 0&&(a[0]=l,n!==void 0&&(a[1]=n,i!==void 0&&(a[2]=i,o!==void 0&&(a[3]=o)))),a}const U=x;function L(l,n,i,o,a){const d=a??new w(4);return d[0]=l,d[1]=n,d[2]=i,d[3]=o,d}function E(l,n){const i=n??new w(4);return i[0]=Math.ceil(l[0]),i[1]=Math.ceil(l[1]),i[2]=Math.ceil(l[2]),i[3]=Math.ceil(l[3]),i}function O(l,n){const i=n??new w(4);return i[0]=Math.floor(l[0]),i[1]=Math.floor(l[1]),i[2]=Math.floor(l[2]),i[3]=Math.floor(l[3]),i}function Z(l,n){const i=n??new w(4);return i[0]=Math.round(l[0]),i[1]=Math.round(l[1]),i[2]=Math.round(l[2]),i[3]=Math.round(l[3]),i}function J(l,n=0,i=1,o){const a=o??new w(4);return a[0]=Math.min(i,Math.max(n,l[0])),a[1]=Math.min(i,Math.max(n,l[1])),a[2]=Math.min(i,Math.max(n,l[2])),a[3]=Math.min(i,Math.max(n,l[3])),a}function $(l,n,i){const o=i??new w(4);return o[0]=l[0]+n[0],o[1]=l[1]+n[1],o[2]=l[2]+n[2],o[3]=l[3]+n[3],o}function at(l,n,i,o){const a=o??new w(4);return a[0]=l[0]+n[0]*i,a[1]=l[1]+n[1]*i,a[2]=l[2]+n[2]*i,a[3]=l[3]+n[3]*i,a}function N(l,n,i){const o=i??new w(4);return o[0]=l[0]-n[0],o[1]=l[1]-n[1],o[2]=l[2]-n[2],o[3]=l[3]-n[3],o}const m=N;function b(l,n){return Math.abs(l[0]-n[0])<F&&Math.abs(l[1]-n[1])<F&&Math.abs(l[2]-n[2])<F&&Math.abs(l[3]-n[3])<F}function Mt(l,n){return l[0]===n[0]&&l[1]===n[1]&&l[2]===n[2]&&l[3]===n[3]}function St(l,n,i,o){const a=o??new w(4);return a[0]=l[0]+i*(n[0]-l[0]),a[1]=l[1]+i*(n[1]-l[1]),a[2]=l[2]+i*(n[2]-l[2]),a[3]=l[3]+i*(n[3]-l[3]),a}function xt(l,n,i,o){const a=o??new w(4);return a[0]=l[0]+i[0]*(n[0]-l[0]),a[1]=l[1]+i[1]*(n[1]-l[1]),a[2]=l[2]+i[2]*(n[2]-l[2]),a[3]=l[3]+i[3]*(n[3]-l[3]),a}function Et(l,n,i){const o=i??new w(4);return o[0]=Math.max(l[0],n[0]),o[1]=Math.max(l[1],n[1]),o[2]=Math.max(l[2],n[2]),o[3]=Math.max(l[3],n[3]),o}function Gt(l,n,i){const o=i??new w(4);return o[0]=Math.min(l[0],n[0]),o[1]=Math.min(l[1],n[1]),o[2]=Math.min(l[2],n[2]),o[3]=Math.min(l[3],n[3]),o}function Dt(l,n,i){const o=i??new w(4);return o[0]=l[0]*n,o[1]=l[1]*n,o[2]=l[2]*n,o[3]=l[3]*n,o}const nt=Dt;function Ut(l,n,i){const o=i??new w(4);return o[0]=l[0]/n,o[1]=l[1]/n,o[2]=l[2]/n,o[3]=l[3]/n,o}function Pt(l,n){const i=n??new w(4);return i[0]=1/l[0],i[1]=1/l[1],i[2]=1/l[2],i[3]=1/l[3],i}const Bt=Pt;function _t(l,n){return l[0]*n[0]+l[1]*n[1]+l[2]*n[2]+l[3]*n[3]}function zt(l){const n=l[0],i=l[1],o=l[2],a=l[3];return Math.sqrt(n*n+i*i+o*o+a*a)}const At=zt;function C(l){const n=l[0],i=l[1],o=l[2],a=l[3];return n*n+i*i+o*o+a*a}const Lt=C;function ft(l,n){const i=l[0]-n[0],o=l[1]-n[1],a=l[2]-n[2],d=l[3]-n[3];return Math.sqrt(i*i+o*o+a*a+d*d)}const Ot=ft;function et(l,n){const i=l[0]-n[0],o=l[1]-n[1],a=l[2]-n[2],d=l[3]-n[3];return i*i+o*o+a*a+d*d}const R=et;function k(l,n){const i=n??new w(4),o=l[0],a=l[1],d=l[2],p=l[3],M=Math.sqrt(o*o+a*a+d*d+p*p);return M>1e-5?(i[0]=o/M,i[1]=a/M,i[2]=d/M,i[3]=p/M):(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}function I(l,n){const i=n??new w(4);return i[0]=-l[0],i[1]=-l[1],i[2]=-l[2],i[3]=-l[3],i}function lt(l,n){const i=n??new w(4);return i[0]=l[0],i[1]=l[1],i[2]=l[2],i[3]=l[3],i}const It=lt;function j(l,n,i){const o=i??new w(4);return o[0]=l[0]*n[0],o[1]=l[1]*n[1],o[2]=l[2]*n[2],o[3]=l[3]*n[3],o}const Rt=j;function yt(l,n,i){const o=i??new w(4);return o[0]=l[0]/n[0],o[1]=l[1]/n[1],o[2]=l[2]/n[2],o[3]=l[3]/n[3],o}const kt=yt;function gt(l){const n=l??new w(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n}function Ft(l,n,i){const o=i??new w(4),a=l[0],d=l[1],p=l[2],M=l[3];return o[0]=n[0]*a+n[4]*d+n[8]*p+n[12]*M,o[1]=n[1]*a+n[5]*d+n[9]*p+n[13]*M,o[2]=n[2]*a+n[6]*d+n[10]*p+n[14]*M,o[3]=n[3]*a+n[7]*d+n[11]*p+n[15]*M,o}function Vt(l,n,i){const o=i??new w(4);return k(l,o),Dt(o,n,o)}function D(l,n,i){const o=i??new w(4);return zt(l)>n?Vt(l,n,o):lt(l,o)}function P(l,n,i){const o=i??new w(4);return St(l,n,.5,o)}return{create:x,fromValues:U,set:L,ceil:E,floor:O,round:Z,clamp:J,add:$,addScaled:at,subtract:N,sub:m,equalsApproximately:b,equals:Mt,lerp:St,lerpV:xt,max:Et,min:Gt,mulScalar:Dt,scale:nt,divScalar:Ut,inverse:Pt,invert:Bt,dot:_t,length:zt,len:At,lengthSq:C,lenSq:Lt,distance:ft,dist:Ot,distanceSq:et,distSq:R,normalize:k,negate:I,copy:lt,clone:It,multiply:j,mul:Rt,divide:yt,div:kt,zero:gt,transformMat4:Ft,setLength:Vt,truncate:D,midpoint:P}}const xn=new Map;function In(w){let x=xn.get(w);return x||(x=On(w),xn.set(w,x)),x}function en(w,x,U,L,E,O){return{mat3:Un(w),mat4:Fn(x),quat:Ln(U),vec2:Dn(L),vec3:Ct(E),vec4:In(O)}}const{mat4:K}=en(Float32Array,Float32Array,Float32Array,Float32Array,Float32Array,Float32Array);en(Float64Array,Float64Array,Float64Array,Float64Array,Float64Array,Float64Array);en(Tn,Array,Array,Array,Array,Array);class yn extends $t{#n=[0,0,0];#t=[0,0,0];#e=[1,1,1];#s=K.identity();#o=!0;update(){this.#o&&this.#c()}setPosition(x){this.#n=x,this.#o=!0}setRotation(x){this.#t=x,this.#o=!0}setScale(x){this.#e=x,this.#o=!0}getPosition(){return this.#n}getRotation(){return this.#t}getScale(){return this.#e}getMatrix(){return this.#o&&this.#c(),this.#s}getBasisX(){return[this.#s[0],this.#s[4],this.#s[8]]}getBasisY(){return[this.#s[1],this.#s[5],this.#s[9]]}getBasisZ(){return[this.#s[2],this.#s[6],this.#s[10]]}isModified(){return this.#o}#c(){const x=K.identity();K.translate(x,this.#n,x),K.rotateX(x,this.#t[0],x),K.rotateY(x,this.#t[1],x),K.rotateZ(x,this.#t[2],x),K.scale(x,this.#e,x),this.#s=x,this.#o=!1}constructor(x,U,L){super(),this.#n=x,this.#t=U,this.#e=L,this.#c()}}class Rn extends yn{#n=[0,0,0];#t=[0,0,0];#e=K.identity();#s=!0;update(){this.#s&&this.#o()}setPosition(x){this.#n[0]=-x[0],this.#n[1]=-x[1],this.#n[2]=-x[2],this.#s=!0}setRotation(x){this.#t[0]=-x[0],this.#t[1]=-x[1],this.#t[2]=-x[2],this.#s=!0}isModified(){return this.#s}getMatrix(){return this.#e}getBasisX(){return[this.#e[0],this.#e[4],this.#e[8]]}getBasisY(){return[this.#e[1],this.#e[5],this.#e[9]]}getBasisZ(){return[this.#e[2],this.#e[6],this.#e[10]]}#o(){const x=K.identity();K.rotateX(x,this.#t[0],x),K.rotateY(x,this.#t[1],x),K.rotateZ(x,this.#t[2],x),K.translate(x,this.#n,x),this.#e=x,this.#s=!1}constructor(x,U){super(x,U,[0,0,0])}}class kn{canvas=null;adapter=null;device=null;context=null;commandEncoder=null;renderPassEncoder=null;colorScreenTexture=null;colorScreenTextureFormat=null;depthTexture=null;depthTextureFormat="depth24plus";async compileShader(x){const U="./shader/"+x;let E=await(await fetch(U)).text();const O=E.split(`
`);for(let Z=0;Z<O.length;Z++){const J=O[Z];if(!J.startsWith("#import"))continue;const $=J.split('"')[1],N=await(await fetch("./shader/"+$)).text();O[Z]=N}return E=O.join(`
`),this.device.createShaderModule({code:E})}updateDepthTexture(){this.depthTexture!=null&&this.depthTexture.destroy(),this.depthTexture=v.device.createTexture({format:this.depthTextureFormat,size:[this.canvas.width,this.canvas.height],usage:GPUTextureUsage.RENDER_ATTACHMENT})}}const v=new kn;class Xn{#n={r:0,g:0,b:0,a:1};setClearColor(x,U,L){this.#n={r:x,g:U,b:L,a:1}}startRender(){v.colorScreenTexture=v.context.getCurrentTexture(),v.commandEncoder=v.device.createCommandEncoder(),nn=Xt.translation.isModified()}beginRenderPass(){v.renderPassEncoder=v.commandEncoder.beginRenderPass({colorAttachments:[{loadOp:"clear",storeOp:"store",view:v.colorScreenTexture.createView(),clearValue:this.#n}],depthStencilAttachment:{view:v.depthTexture.createView(),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store"}})}endRenderPass(){v.renderPassEncoder.end()}finishRender(){const x=v.commandEncoder.finish();v.device.queue.submit([x]),nn=!1}}const Zt=new Xn;let nn=!0;class Yn extends $t{#n=Math.PI/4;#t=K.identity();#e=K.identity();#s=!0;#o=!0;translation=new Rn([0,0,0],[0,0,0]);updateProjectionMatrix(){this.#e=K.mul(K.perspective(this.#n,window.innerWidth/window.innerHeight,.1,200),new Float32Array([1,0,0,0,0,1,0,0,0,0,-1,0,0,0,0,1]))}getViewMatrix(){return this.translation.getMatrix()}getProjectionMatrix(){return this.#s&&this.updateProjectionMatrix(),this.#e}}const Xt=new Yn;class jn{constructor(){}use(x){}updateModelMatrixUniforms(x){}}class Yt extends jn{#n=null;#t=null;#e=null;static ViewMatrixBindGroupLayout=null;static TextureBindGroupLayout=null;static PipelineLayout=null;constructor(x,U,L){super(),this.#n=v.device.createRenderPipeline({layout:Yt.PipelineLayout,vertex:{module:x,buffers:[{arrayStride:12,attributes:[{format:"float32x3",offset:0,shaderLocation:0}]},{arrayStride:12,attributes:[{format:"float32x3",offset:0,shaderLocation:1}]},{arrayStride:12,attributes:[{format:"float32x3",offset:0,shaderLocation:2}]},{arrayStride:8,attributes:[{format:"float32x2",offset:0,shaderLocation:3}]}],entryPoint:"vs_main"},fragment:{module:x,targets:[{format:v.colorScreenTextureFormat}],entryPoint:"fs_main"},depthStencil:{format:"depth24plus",depthCompare:"less",depthWriteEnabled:!0},primitive:{topology:"triangle-list",frontFace:"cw",cullMode:L}}),this.#t=U,this.#e=v.device.createBindGroup({layout:this.#n.getBindGroupLayout(1),entries:[{binding:0,resource:this.#t.texture.createView()},{binding:1,resource:U.sampler}]})}use(x){x.setPipeline(this.#n),x.setBindGroup(1,this.#e)}}class gn{texture=null;sampler=null;constructor(x,U){this.texture=v.device.createTexture({format:v.colorScreenTextureFormat,size:[x.width,x.height],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT}),v.device.queue.copyExternalImageToTexture({source:x},{texture:this.texture},{width:x.width,height:x.height}),this.sampler=v.device.createSampler({minFilter:U,magFilter:U,mipmapFilter:"linear"})}destroy(){this.texture.destroy()}}class Sn{surfaces=[];positionBuffer=null;normalBuffer=null;colorBuffer=null;uvBuffer=null;indexBuffer=null;materials=[];constructor(){}addSurface(x,U){this.surfaces.push(U),this.materials.push(x)}commitSurfaces(){const x=new Array,U=new Array,L=new Array,E=new Array,O=new Array;for(let m=0;m<this.surfaces.length;m++){const b=this.surfaces[m];x.push(...b.position),U.push(...b.normal),L.push(...b.color),E.push(...b.uv),O.push(...b.index)}this.positionBuffer&&this.positionBuffer.destroy(),this.normalBuffer&&this.normalBuffer.destroy(),this.colorBuffer&&this.colorBuffer.destroy(),this.uvBuffer&&this.uvBuffer.destroy(),this.indexBuffer&&this.indexBuffer.destroy();const Z=new Float32Array(x),J=new Float32Array(U),$=new Float32Array(L),at=new Float32Array(E),N=new Int32Array(O);this.positionBuffer=v.device.createBuffer({size:Z.length*4,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),v.device.queue.writeBuffer(this.positionBuffer,0,Z),this.normalBuffer=v.device.createBuffer({size:J.length*4,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),v.device.queue.writeBuffer(this.normalBuffer,0,J),this.colorBuffer=v.device.createBuffer({size:$.length*4,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),v.device.queue.writeBuffer(this.colorBuffer,0,$),this.uvBuffer=v.device.createBuffer({size:at.length*4,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),v.device.queue.writeBuffer(this.uvBuffer,0,at),this.indexBuffer=v.device.createBuffer({size:N.length*4,usage:GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST}),v.device.queue.writeBuffer(this.indexBuffer,0,N)}clearSurfaces(){this.surfaces=[],this.materials=[]}destroy(){this.positionBuffer.destroy(),this.normalBuffer.destroy(),this.colorBuffer.destroy(),this.uvBuffer.destroy(),this.indexBuffer.destroy()}}class Pn extends $t{#n={viewMatrix:{buffer:null,bindGroup:null}};#t=null;translation;visible=!0;#e(x){v.device.queue.writeBuffer(this.#n.viewMatrix.buffer,0,this.translation.getMatrix())}#s(){const x=K.mul(Xt.getProjectionMatrix(),Xt.getViewMatrix());v.device.queue.writeBuffer(this.#n.viewMatrix.buffer,64,x)}render(){if(this.visible){v.renderPassEncoder.setVertexBuffer(0,this.#t.positionBuffer),v.renderPassEncoder.setVertexBuffer(1,this.#t.normalBuffer),v.renderPassEncoder.setVertexBuffer(2,this.#t.colorBuffer),v.renderPassEncoder.setVertexBuffer(3,this.#t.uvBuffer),v.renderPassEncoder.setIndexBuffer(this.#t.indexBuffer,"uint32");let x=0;for(let U=0;U<this.#t.surfaces.length;U++){const L=this.#t.surfaces[U],E=this.#t.materials[U];this.translation.isModified()&&this.#e(E),nn&&this.#s(),E.use(v.renderPassEncoder),v.renderPassEncoder.setBindGroup(0,this.#n.viewMatrix.bindGroup),v.renderPassEncoder.drawIndexed(L.index.length,1,x,x),x+=L.index.length}}}constructor(x,U,L,E){super(),this.#t=x,this.translation=new yn(U,L,E),this.#n.viewMatrix.buffer=v.device.createBuffer({size:128,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM}),this.#n.viewMatrix.bindGroup=v.device.createBindGroup({layout:Yt.ViewMatrixBindGroupLayout,entries:[{binding:0,resource:{buffer:this.#n.viewMatrix.buffer}}]}),this.#e(),this.#s()}}async function Zn(){if(v.canvas=document.createElement("canvas"),v.canvas.style.backgroundColor="#012345ff",v.canvas.style.position="fixed",document.body.appendChild(v.canvas),!navigator.gpu)throw new Error("This web browser does not support WebGPU.");if(v.adapter=await navigator.gpu.requestAdapter(),!v.adapter)throw new Error("Could not get GPUAdapter.");if(v.device=await v.adapter.requestDevice(),!v.device)throw new Error("Could not get GPUDevice.");if(v.colorScreenTextureFormat=navigator.gpu.getPreferredCanvasFormat(),v.context=v.canvas.getContext("webgpu"),!v.context)throw new Error("Could not get the WebGPU context.");v.context.configure({device:v.device,format:v.colorScreenTextureFormat}),v.updateDepthTexture(),Yt.ViewMatrixBindGroupLayout=v.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}}]}),Yt.TextureBindGroupLayout=v.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{}}]}),Yt.PipelineLayout=v.device.createPipelineLayout({bindGroupLayouts:[Yt.ViewMatrixBindGroupLayout,Yt.TextureBindGroupLayout]});const w=()=>{v.canvas.width=window.innerWidth*window.devicePixelRatio,v.canvas.height=window.innerHeight*window.devicePixelRatio,v.canvas.style.width="100%",v.canvas.style.height="100%",Xt.updateProjectionMatrix(),v.updateDepthTexture()};window.addEventListener("resize",w),w()}await Zn();let bt=!1;class $n extends $t{lookRotation=[0,0,0];lookSensitivity=.01;movmentMultiplier=.1;start(){}update(){bt&&(this.lookRotation[1]+=V.look_delta[0]*this.lookSensitivity,this.lookRotation[0]+=V.look_delta[1]*-this.lookSensitivity,Xt.translation.setRotation(this.lookRotation),V.look_delta[0]=0,V.look_delta[1]=0,Xt.translation.setRotation(this.lookRotation)),V.direction[0]=V.move_right-V.move_left,V.direction[1]=V.move_up-V.move_down,V.direction[2]=V.move_forward-V.move_backward;const x=Xt.translation.getBasisX(),U=Xt.translation.getBasisY(),L=Xt.translation.getBasisZ(),E=Xt.translation.getPosition();E[0]+=x[0]*V.direction[0]*this.movmentMultiplier,E[1]+=x[1]*V.direction[0]*this.movmentMultiplier,E[2]+=x[2]*V.direction[0]*this.movmentMultiplier,E[0]+=U[0]*V.direction[1]*this.movmentMultiplier,E[1]+=U[1]*V.direction[1]*this.movmentMultiplier,E[2]+=U[2]*V.direction[1]*this.movmentMultiplier,E[0]+=L[0]*V.direction[2]*this.movmentMultiplier,E[1]+=L[1]*V.direction[2]*this.movmentMultiplier,E[2]+=L[2]*V.direction[2]*this.movmentMultiplier,Xt.translation.setPosition(E),this.a+=.01}a=0;render(){}}const V={move_forward:0,move_backward:0,move_up:0,move_down:0,move_left:0,move_right:0,look_delta:[0,0],direction:[0,0,0]};window.addEventListener("mousemove",w=>{V.look_delta[0]=w.movementX,V.look_delta[1]=-w.movementY});window.addEventListener("keyup",w=>{w.key=="Escape"&&Nn(),w.key==" "&&(V.move_up=0),w.key=="Shift"&&(V.move_down=0),w.key=="w"&&(V.move_forward=0),w.key=="a"&&(V.move_left=0),w.key=="s"&&(V.move_backward=0),w.key=="d"&&(V.move_right=0)});window.addEventListener("keydown",w=>{w.key==" "&&(V.move_up=1),w.key=="Shift"&&(V.move_down=1),w.key=="w"&&(V.move_forward=1),w.key=="a"&&(V.move_left=1),w.key=="s"&&(V.move_backward=1),w.key=="d"&&(V.move_right=1)});function Nn(){if(bt=!bt,bt){v.canvas.requestPointerLock();return}}class mn{position=[0,1,1,1,1,1,0,1,0,1,1,0,1,0,1,0,0,1,1,0,0,0,0,0,1,1,1,0,1,1,1,0,1,0,0,1,0,1,0,1,1,0,0,0,0,1,0,0,1,1,0,1,1,1,1,0,0,1,0,1,0,1,1,0,1,0,0,0,1,0,0,0];normal=[0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0];color=[1,0,0,1,0,0,1,0,0,1,0,0,1,.5,0,1,.5,0,1,.5,0,1,.5,0,1,1,0,1,1,0,1,1,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,1,0,1,1,0,1,1,0,1,1,0,1];uv=[0,0,1,0,0,1,1,1,0,0,1,0,0,1,1,1,0,0,1,0,0,1,1,1,0,0,1,0,0,1,1,1,0,0,1,0,0,1,1,1,0,0,1,0,0,1,1,1];index=[0,1,2,2,1,3,4,5,6,6,5,7,8,9,10,10,9,11,12,13,14,14,13,15,16,17,18,18,17,19,20,21,22,22,21,23]}const jt=new mn,sn=new Image;sn.src="game-assets/block_atlas.png";await sn.decode();const on=new Image;on.src="game-assets/purple.png";await on.decode();const Hn=new gn(sn,"nearest"),Bn=await v.compileShader("Solid.wgsl"),Wn=new Yt(Bn,Hn,"back"),Qn=new gn(on,"nearest"),Kn=new Yt(Bn,Qn,"none"),cn=new Sn;cn.addSurface(Wn,{position:jt.position,normal:jt.normal,color:jt.color,uv:jt.uv,index:jt.index});cn.commitSurfaces();const rn=new Sn;rn.addSurface(Kn,{position:jt.position,normal:jt.normal,color:jt.color,uv:jt.uv,index:jt.index});rn.commitSurfaces();new Pn(cn,[0,0,0],[0,0,0],[10,1,10]);new Pn(rn,[5,1,5],[0,0,0],[1,1,1]);new $n;class Jn extends $t{start(){Zt.setClearColor(.1,.2,.3)}update(){}}new Jn;function zn(){tn.updateStep(),Zt.startRender(),Zt.beginRenderPass(),tn.renderStep(),Zt.endRenderPass(),Zt.finishRender(),requestAnimationFrame(zn)}zn();
